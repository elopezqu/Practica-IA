<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Selección de Departamentos y Provincias</title>
</head>
<body>
  <h1>Selección de Departamentos y Provincias</h1>
  
  <label for="paises">Selecciona un Pais:</label>
  <select id="paises" name="paises">
    <!-- Aquí se cargarán dinámicamente los departamentos desde la API -->
  </select>
  
  <br><br>
  
  <label for="departamentos">Selecciona un departamentos:</label>
  <select id="departamentos" name="departamentos">
    <!-- Aquí se cargarán dinámicamente las provincias según el departamento seleccionado -->
  </select>

  <br><br>
  
  <label for="provincias">Selecciona una provincia:</label>
  <select id="provincias" name="provincias">
    <!-- Aquí se cargarán dinámicamente las provincias según el departamento seleccionado -->
  </select>

  <br><br>
  
  <label for="distritos">Selecciona una distrito:</label>
  <select id="distritos" name="distritos">
    <!-- Aquí se cargarán dinámicamente las provincias según el departamento seleccionado -->
  </select>
  
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function() {
      // Obtener la lista de paises al cargar la página
      var selectPaises = $('#paises');
      selectPaises.empty().append($('<option>').text('Selecciona un país').attr('value', ''));
      $.get('/api/paises', function(data) {  
        data.paises.forEach(function(paises) {
          selectPaises.append($('<option>').text(paises.pais).attr('value', paises.idPais));
        });
      });
      /*
      var idPais = $('#paises').val();
      console.log(idPais);
      if (!idPais) {
        idPais = 1; // Si idPais no tiene valor, se establece en 1 por defecto
      }
      console.log(idPais);
      $.get('/api/departamentos/' + idPais, function (data) {
        var selectDepartamentos = $('#departamentos');
        selectDepartamentos.empty();
        console.log(data);
        data.departamentos.forEach(function (departamento) {
          selectDepartamentos.append($('<option>').text(departamento.departamento).attr('value', departamento.idDepartamento));
        });
      });

      */
      
      // Manejar la selección de departamentos para cargar las provincias correspondientes
      
    });
    $('#paises').change(function () {
        var idPais = $(this).val();
        console.log(idPais);
        $('#provincias').empty(); // Limpiar la lista de provincias al cambiar el país
        $('#distritos').empty(); // Limpiar la lista de distritos al cambiar el país
        $.get('/api/departamentos/' + idPais, function (data) {
          var selectDepartamentos = $('#departamentos');
          selectDepartamentos.empty().append($('<option>').text('Selecciona un departamento').attr('value', ''));
          data.departamentos.forEach(function (departamentos) {
            selectDepartamentos.append($('<option>').text(departamentos.departamento).attr('value', departamentos.departamentos));
          });
        });
      });
      $('#departamentos').change(function() {
        var departamento = $(this).val();
        console.log(departamento);
        $('#distritos').empty(); // Limpiar la lista de distritos al cambiar el país
        $.get('/api/provincias/' + departamento, function(data) {
          var selectProvincias = $('#provincias');
          selectProvincias.empty().append($('<option>').text('Selecciona un provincia').attr('value', ''));
          data.provincias.forEach(function(provincia) {
            selectProvincias.append($('<option>').text(provincia.provincia).attr('value', provincia.provincia));
          });
        });
      });
      $('#provincias').change(function() {
        var provincia = $(this).val();
        console.log(provincia);
        $.get('/api/distritos/' + provincia, function(data) {
          var selectDistritos = $('#distritos');
          selectDistritos.empty().append($('<option>').text('Selecciona un Distrito').attr('value', ''));
          data.distritos.forEach(function(distrito) {
            selectDistritos.append($('<option>').text(distrito.distrito).attr('value', distrito.idDistrito));
          });
        });
      });
      </script>
  </body>
  
  </html>